# ğŸ“‹ Level 2 ë¶€ë¶„ ìë™í™” ìƒì„¸ êµ¬í˜„ ê³„íš

## ğŸ¯ ëª©í‘œ
- ì‚¬ìš©ìê°€ ê´€ì‹¬ í‘œì‹œí•œ ê¸°ì‚¬ë¥¼ ì‰½ê²Œ ì¹´ë“œë‰´ìŠ¤ë¡œ ë³€í™˜
- Claude AIì™€ì˜ ëŒ€í™”í˜• ì¸í„°í˜ì´ìŠ¤ë¡œ í’ˆì§ˆ ê´€ë¦¬
- ë¹„ìš© íš¨ìœ¨ì ì¸ ìš´ì˜

## ğŸ”§ êµ¬í˜„ ì»´í¬ë„ŒíŠ¸

### 1. ê´€ì‹¬ ê¸°ì‚¬ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸
`watch_interested_articles.py`

```python
import time
import json
from datetime import datetime
from notion.notion_client import NotionClient

class InterestMonitor:
    def __init__(self):
        self.notion = NotionClient()
        self.processed_articles = self.load_processed()
        
    def load_processed(self):
        """ì´ë¯¸ ì²˜ë¦¬í•œ ê¸°ì‚¬ ID ë¡œë“œ"""
        try:
            with open('processed_articles.json', 'r') as f:
                return set(json.load(f))
        except:
            return set()
    
    def save_processed(self, article_id):
        """ì²˜ë¦¬ ì™„ë£Œí•œ ê¸°ì‚¬ ID ì €ì¥"""
        self.processed_articles.add(article_id)
        with open('processed_articles.json', 'w') as f:
            json.dump(list(self.processed_articles), f)
    
    def check_new_interests(self):
        """ìƒˆë¡œìš´ ê´€ì‹¬ ê¸°ì‚¬ í™•ì¸"""
        # ëª¨ë“  ì£¼ì°¨ì˜ ê´€ì‹¬ ê¸°ì‚¬ ê°€ì ¸ì˜¤ê¸°
        interested = self.notion.get_interested_articles()
        
        new_articles = []
        for article in interested:
            if article['page_id'] not in self.processed_articles:
                new_articles.append(article)
                
        return new_articles
    
    def run(self, interval=300):  # 5ë¶„ë§ˆë‹¤ ì²´í¬
        """ëª¨ë‹ˆí„°ë§ ì‹¤í–‰"""
        print("ğŸ” ê´€ì‹¬ ê¸°ì‚¬ ëª¨ë‹ˆí„°ë§ ì‹œì‘...")
        
        while True:
            new_articles = self.check_new_interests()
            
            if new_articles:
                print(f"âœ¨ ìƒˆë¡œìš´ ê´€ì‹¬ ê¸°ì‚¬ {len(new_articles)}ê°œ ë°œê²¬!")
                # ì›¹ UIìš© íŒŒì¼ì— ì €ì¥
                with open('pending_cardnews.json', 'w', encoding='utf-8') as f:
                    json.dump(new_articles, f, ensure_ascii=False, indent=2)
            
            time.sleep(interval)
```

### 2. Streamlit ì›¹ UI
`card_news_app.py`

```python
import streamlit as st
import json
from pathlib import Path
import anthropic
from datetime import datetime

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(
    page_title="ì „ë ¥ì‚°ì—… ì¹´ë“œë‰´ìŠ¤ ìƒì„±ê¸°",
    page_icon="âš¡",
    layout="wide"
)

class CardNewsApp:
    def __init__(self):
        self.anthropic_client = None
        self.setup_api()
        
    def setup_api(self):
        """API ì„¤ì •"""
        api_key = st.secrets.get("ANTHROPIC_API_KEY")
        if api_key:
            self.anthropic_client = anthropic.Anthropic(api_key=api_key)
    
    def load_pending_articles(self):
        """ëŒ€ê¸° ì¤‘ì¸ ê¸°ì‚¬ ë¡œë“œ"""
        try:
            with open('pending_cardnews.json', 'r', encoding='utf-8') as f:
                return json.load(f)
        except:
            return []
    
    def generate_card_news(self, article):
        """Claudeë¥¼ í†µí•œ ì¹´ë“œë‰´ìŠ¤ ìƒì„±"""
        prompt = f"""
        ì „ë ¥ì‚°ì—… ê´€ë ¨ ê¸°ì‚¬ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë§¤ë ¥ì ì¸ HTML ì¹´ë“œë‰´ìŠ¤ë¡œ ë§Œë“¤ì–´ì£¼ì„¸ìš”.
        
        [ê¸°ì‚¬ ì •ë³´]
        ì œëª©: {article['title']}
        ìš”ì•½: {article['summary']}
        í•µì‹¬ë‚´ìš©: {article['content']}
        í‚¤ì›Œë“œ: {', '.join(article.get('keywords', []))}
        
        [ìš”êµ¬ì‚¬í•­]
        1. ë‹¤í¬ í…Œë§ˆ (#0a0a0a ë°°ê²½)
        2. ì£¼ì œì— ë§ëŠ” ìƒ‰ìƒ í…Œë§ˆ ì„ íƒ
        3. íˆì–´ë¡œ ì„¹ì…˜ + í•µì‹¬ ì¸ì‚¬ì´íŠ¸ + ë°ì´í„° ì‹œê°í™” + ì „ë§
        4. ì¸í„°ë™í‹°ë¸Œ ì• ë‹ˆë©”ì´ì…˜ (hover, scroll, counter)
        5. Pretendard í°íŠ¸ ì‚¬ìš©
        6. ë°˜ì‘í˜• ë””ìì¸
        
        ì™„ì „í•œ HTML íŒŒì¼ì„ ìƒì„±í•´ì£¼ì„¸ìš”.
        """
        
        with st.spinner('ğŸ¨ ì¹´ë“œë‰´ìŠ¤ ìƒì„± ì¤‘...'):
            response = self.anthropic_client.messages.create(
                model="claude-3-opus-20240229",
                messages=[{"role": "user", "content": prompt}],
                max_tokens=4000
            )
            
        return response.content[0].text
    
    def run(self):
        """ì•± ì‹¤í–‰"""
        st.title("âš¡ ì „ë ¥ì‚°ì—… ì¹´ë“œë‰´ìŠ¤ ìƒì„±ê¸°")
        
        # ì‚¬ì´ë“œë°”
        with st.sidebar:
            st.header("ğŸ“‹ ì„¤ì •")
            
            # API í‚¤ í™•ì¸
            if not self.anthropic_client:
                st.error("âš ï¸ Anthropic API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
                api_key = st.text_input("API Key", type="password")
                if api_key:
                    self.anthropic_client = anthropic.Anthropic(api_key=api_key)
                    st.success("âœ… API ì—°ê²° ì„±ê³µ!")
            
            # ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
            if st.button("ğŸ”„ ê¸°ì‚¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨"):
                st.rerun()
        
        # ë©”ì¸ ì»¨í…ì¸ 
        articles = self.load_pending_articles()
        
        if not articles:
            st.info("ğŸ“­ ì¹´ë“œë‰´ìŠ¤ë¡œ ë§Œë“¤ ê´€ì‹¬ ê¸°ì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.")
            return
        
        # ê¸°ì‚¬ ì„ íƒ
        st.header("ğŸ“° ê´€ì‹¬ ê¸°ì‚¬ ëª©ë¡")
        
        # ê¸°ì‚¬ ì¹´ë“œ í‘œì‹œ
        cols = st.columns(2)
        for idx, article in enumerate(articles):
            with cols[idx % 2]:
                with st.container():
                    st.subheader(article['title'])
                    st.caption(f"í‚¤ì›Œë“œ: {', '.join(article.get('keywords', []))}")
                    st.write(article['summary'])
                    
                    if st.button(f"ğŸ¨ ì¹´ë“œë‰´ìŠ¤ ìƒì„±", key=f"gen_{idx}"):
                        self.generate_for_article(article, idx)
    
    def generate_for_article(self, article, idx):
        """íŠ¹ì • ê¸°ì‚¬ì˜ ì¹´ë“œë‰´ìŠ¤ ìƒì„±"""
        st.header(f"ğŸ¨ ì¹´ë“œë‰´ìŠ¤ ìƒì„±: {article['title']}")
        
        # ìƒì„± ì˜µì…˜
        col1, col2 = st.columns(2)
        with col1:
            color_theme = st.selectbox(
                "ìƒ‰ìƒ í…Œë§ˆ",
                ["ìë™ ì„ íƒ", "ESS/ë°°í„°ë¦¬ (ì´ˆë¡/íŒŒë‘)", "íƒœì–‘ê´‘ (ë…¸ë‘/ì£¼í™©)", 
                 "ì •ì±… (íŒŒë‘/ë³´ë¼)", "ë¬¸ì œ/ê²½ê³  (ë¹¨ê°•/ì£¼í™©)"]
            )
        
        with col2:
            emphasis = st.multiselect(
                "ê°•ì¡°í•  ìš”ì†Œ",
                ["ì°¨íŠ¸/ê·¸ë˜í”„", "íƒ€ì„ë¼ì¸", "ë¹„êµ í…Œì´ë¸”", "ì¸ìš©êµ¬", "í†µê³„ ì¹´ìš´í„°"]
            )
        
        if st.button("ğŸš€ ìƒì„± ì‹œì‘"):
            # Claude API í˜¸ì¶œ
            html_content = self.generate_card_news(article)
            
            # ë¯¸ë¦¬ë³´ê¸°
            st.subheader("ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°")
            st.components.v1.html(html_content, height=800, scrolling=True)
            
            # ì €ì¥ ì˜µì…˜
            col1, col2, col3 = st.columns(3)
            
            with col1:
                if st.button("ğŸ’¾ ì €ì¥"):
                    filename = f"detail_{article['title'][:30]}_{datetime.now().strftime('%Y%m%d_%H%M%S')}.html"
                    output_path = Path("detailed") / filename
                    output_path.parent.mkdir(exist_ok=True)
                    
                    with open(output_path, 'w', encoding='utf-8') as f:
                        f.write(html_content)
                    
                    st.success(f"âœ… ì €ì¥ ì™„ë£Œ: {filename}")
                    
                    # ì²˜ë¦¬ ì™„ë£Œ í‘œì‹œ
                    self.mark_as_processed(article['page_id'])
            
            with col2:
                if st.button("âœï¸ ìˆ˜ì • ìš”ì²­"):
                    self.request_modification(html_content, article)
            
            with col3:
                if st.button("ğŸ”„ ë‹¤ì‹œ ìƒì„±"):
                    st.rerun()

if __name__ == "__main__":
    app = CardNewsApp()
    app.run()
```

### 3. í†µí•© ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
`run_level2_automation.py`

```python
#!/usr/bin/env python3
import subprocess
import time
from pathlib import Path

def run_monitoring():
    """ë°±ê·¸ë¼ìš´ë“œì—ì„œ ê´€ì‹¬ ê¸°ì‚¬ ëª¨ë‹ˆí„°ë§"""
    subprocess.Popen(['python', 'watch_interested_articles.py'])
    print("âœ… ê´€ì‹¬ ê¸°ì‚¬ ëª¨ë‹ˆí„°ë§ ì‹œì‘")

def run_streamlit():
    """Streamlit ì›¹ UI ì‹¤í–‰"""
    subprocess.run(['streamlit', 'run', 'card_news_app.py'])

def main():
    print("ğŸš€ Level 2 ìë™í™” ì‹œìŠ¤í…œ ì‹œì‘")
    
    # 1. ëª¨ë‹ˆí„°ë§ ì‹œì‘
    run_monitoring()
    
    # 2. ì ì‹œ ëŒ€ê¸°
    time.sleep(2)
    
    # 3. ì›¹ UI ì‹¤í–‰
    print("ğŸŒ ì›¹ UI ì‹œì‘ ì¤‘...")
    print("ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8501 ì ‘ì†")
    run_streamlit()

if __name__ == "__main__":
    main()
```

## ğŸ’¡ ì£¼ìš” ê¸°ëŠ¥

### 1. **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**
- 5ë¶„ë§ˆë‹¤ ë…¸ì…˜ ì²´í¬
- ìƒˆ ê´€ì‹¬ ê¸°ì‚¬ ìë™ ê°ì§€
- JSON íŒŒì¼ë¡œ ìƒíƒœ ê´€ë¦¬

### 2. **ì›¹ ì¸í„°í˜ì´ìŠ¤**
- ê¹”ë”í•œ UIë¡œ ê¸°ì‚¬ ëª©ë¡ í‘œì‹œ
- ì›í´ë¦­ ì¹´ë“œë‰´ìŠ¤ ìƒì„±
- ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
- ìˆ˜ì • ìš”ì²­ ê¸°ëŠ¥

### 3. **í’ˆì§ˆ ê´€ë¦¬**
- ìƒì„± ì „: ìƒ‰ìƒ í…Œë§ˆ, ê°•ì¡° ìš”ì†Œ ì„ íƒ
- ìƒì„± í›„: ë¯¸ë¦¬ë³´ê¸°, ìˆ˜ì •, ì¬ìƒì„±
- ì™„ì„±ë³¸ë§Œ ì €ì¥

### 4. **ë¹„ìš© í†µì œ**
- ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê¸°ì‚¬ë§Œ ìƒì„±
- ìƒì„± íšŸìˆ˜ ì¶”ì 
- ì›”ë³„ ì‚¬ìš©ëŸ‰ ë¦¬í¬íŠ¸

## ğŸ¯ ì¥ì 

1. **ìœ ì—°ì„±**: í•„ìš”í•œ ê¸°ì‚¬ë§Œ ì„ íƒì  ìƒì„±
2. **í’ˆì§ˆ**: ìƒì„± ê³¼ì •ì— ì‚¬ìš©ì ê°œì… ê°€ëŠ¥
3. **ë¹„ìš©**: ì˜ˆì¸¡ ê°€ëŠ¥í•œ API ì‚¬ìš©ëŸ‰
4. **ì‚¬ìš©ì„±**: ì§ê´€ì ì¸ ì›¹ ì¸í„°í˜ì´ìŠ¤
5. **í™•ì¥ì„±**: ê¸°ëŠ¥ ì¶”ê°€ ìš©ì´

## âš ï¸ ë‹¨ì 

1. **ìˆ˜ë™ ê°œì…**: ì™„ì „ ìë™í™” ì•„ë‹˜
2. **ì‹¤í–‰ í•„ìš”**: ì›¹ ì„œë²„ ìƒì‹œ ì‹¤í–‰
3. **ì´ˆê¸° ì„¤ì •**: API í‚¤, í™˜ê²½ êµ¬ì„±

## ğŸ’° ì˜ˆìƒ ë¹„ìš©

- **ì„ íƒì  ìƒì„±**: ì›” 10-30ê°œ ê¸°ì‚¬
- **ë¹„ìš©**: $4-12/ì›” (5,500-16,500ì›)
- **ì™„ì „ ìë™í™” ëŒ€ë¹„ 80% ì ˆê°**

ì´ ë°©ì‹ì´ ê°€ì¥ í˜„ì‹¤ì ì´ê³  ì‹¤ìš©ì ì…ë‹ˆë‹¤!
